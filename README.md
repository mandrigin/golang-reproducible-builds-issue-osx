# golang-reproducible-builds-issue-osx

Shows an issue with reproducible builds when using CGO on macOS.

It builds a simple app twice, and shows SHA1 of the binaries and a hex diff between them.

## Building on Alpine (WORKS)

`./build-n-diff.docker.sh`

Output (files are the same)

```
Step 7/7 : RUN sh ./build-n-diff.sh
 ---> Running in 3608ca23d779
7f3c54028cf086a14622ebc6a55f50d5d6a7a943  -
7f3c54028cf086a14622ebc6a55f50d5d6a7a943  -
DIFF_BEGIN
DIFF_END
```

## Building on macOS (Broken)

`./build-n-diff.sh`

Output (files have path with timestamps, not the same)
```
b95da67ac590c0972180800c0124103f541f4941  -
f82871e37e6b8f16f30431270da044faf2ad553f  -
DIFF_BEGIN
341518c341518
< 005360d0: 822d 0200 6603 0100 393b 415f 0000 0000  .-..f...9;A_....
---
> 005360d0: 822d 0200 6603 0100 3b3b 415f 0000 0000  .-..f...;;A_....
352601c352601
< 00561580: e2de 0300 6603 0100 393b 415f 0000 0000  ....f...9;A_....
---
> 00561580: e2de 0300 6603 0100 3b3b 415f 0000 0000  ....f...;;A_....
352645c352645
< 00561840: 21e0 0300 6603 0100 393b 415f 0000 0000  !...f...9;A_....
---
> 00561840: 21e0 0300 6603 0100 3b3b 415f 0000 0000  !...f...;;A_....
353553c353553
< 00565100: 7d05 0400 6603 0100 393b 415f 0000 0000  }...f...9;A_....
---
> 00565100: 7d05 0400 6603 0100 3b3b 415f 0000 0000  }...f...;;A_....
353577c353577
< 00565280: bc06 0400 6603 0100 393b 415f 0000 0000  ....f...9;A_....
---
> 00565280: bc06 0400 6603 0100 3b3b 415f 0000 0000  ....f...;;A_....
353601c353601
< 00565400: 5908 0400 6603 0100 393b 415f 0000 0000  Y...f...9;A_....
---
> 00565400: 5908 0400 6603 0100 3b3b 415f 0000 0000  Y...f...;;A_....
353629c353629
< 005655c0: 3909 0400 6603 0100 393b 415f 0000 0000  9...f...9;A_....
---
> 005655c0: 3909 0400 6603 0100 3b3b 415f 0000 0000  9...f...;;A_....
353669c353669
< 00565840: 450a 0400 6603 0100 393b 415f 0000 0000  E...f...9;A_....
---
> 00565840: 450a 0400 6603 0100 3b3b 415f 0000 0000  E...f...;;A_....
353703c353703
< 00565a60: 6d0b 0400 6603 0100 393b 415f 0000 0000  m...f...9;A_....
---
> 00565a60: 6d0b 0400 6603 0100 3b3b 415f 0000 0000  m...f...;;A_....
353724c353724
< 00565bb0: 380c 0400 6603 0100 393b 415f 0000 0000  8...f...9;A_....
---
> 00565bb0: 380c 0400 6603 0100 3b3b 415f 0000 0000  8...f...;;A_....
353736c353736
< 00565c70: bd0c 0400 6603 0100 393b 415f 0000 0000  ....f...9;A_....
---
> 00565c70: bd0c 0400 6603 0100 3b3b 415f 0000 0000  ....f...;;A_....
353768c353768
< 00565e70: c80d 0400 6603 0100 393b 415f 0000 0000  ....f...9;A_....
---
> 00565e70: c80d 0400 6603 0100 3b3b 415f 0000 0000  ....f...;;A_....
353788c353788
< 00565fb0: 6b0e 0400 6603 0100 393b 415f 0000 0000  k...f...9;A_....
---
> 00565fb0: 6b0e 0400 6603 0100 3b3b 415f 0000 0000  k...f...;;A_....
353832c353832
< 00566270: 970f 0400 6603 0100 393b 415f 0000 0000  ....f...9;A_....
---
> 00566270: 970f 0400 6603 0100 3b3b 415f 0000 0000  ....f...;;A_....
356712c356712
< 00571670: a958 0400 6603 0100 393b 415f 0000 0000  .X..f...9;A_....
---
> 00571670: a958 0400 6603 0100 3b3b 415f 0000 0000  .X..f...;;A_....
356724c356724
< 00571730: 5059 0400 6603 0100 393b 415f 0000 0000  PY..f...9;A_....
---
> 00571730: 5059 0400 6603 0100 3b3b 415f 0000 0000  PY..f...;;A_....
356744c356744
< 00571870: 7b5a 0400 6603 0100 393b 415f 0000 0000  {Z..f...9;A_....
---
> 00571870: 7b5a 0400 6603 0100 3b3b 415f 0000 0000  {Z..f...;;A_....
356752c356752
< 005718f0: f05a 0400 6603 0100 393b 415f 0000 0000  .Z..f...9;A_....
---
> 005718f0: f05a 0400 6603 0100 3b3b 415f 0000 0000  .Z..f...;;A_....
356772c356772
< 00571a30: 985b 0400 6603 0100 393b 415f 0000 0000  .[..f...9;A_....
---
> 00571a30: 985b 0400 6603 0100 3b3b 415f 0000 0000  .[..f...;;A_....
356808c356808
< 00571c70: 045d 0400 6603 0100 393b 415f 0000 0000  .]..f...9;A_....
---
> 00571c70: 045d 0400 6603 0100 3b3b 415f 0000 0000  .]..f...;;A_....
356820c356820
< 00571d30: 7e5d 0400 6603 0100 393b 415f 0000 0000  ~]..f...9;A_....
---
> 00571d30: 7e5d 0400 6603 0100 3b3b 415f 0000 0000  ~]..f...;;A_....
356828c356828
< 00571db0: e45d 0400 6603 0100 393b 415f 0000 0000  .]..f...9;A_....
---
> 00571db0: e45d 0400 6603 0100 3b3b 415f 0000 0000  .]..f...;;A_....
356841c356841
< 00571e80: 775e 0400 6603 0100 393b 415f 0000 0000  w^..f...9;A_....
---
> 00571e80: 775e 0400 6603 0100 3b3b 415f 0000 0000  w^..f...;;A_....
366526,366527c366526,366527
< 00597bd0: 3030 676e 2f54 2f67 6f2d 6c69 6e6b 2d32  00gn/T/go-link-2
< 00597be0: 3437 3532 3038 3139 2f67 6f2e 6f00 5f72  47520819/go.o._r
---
> 00597bd0: 3030 676e 2f54 2f67 6f2d 6c69 6e6b 2d31  00gn/T/go-link-1
> 00597be0: 3436 3636 3739 3636 2f67 6f2e 6f00 5f72  46667966/go.o._r
373460,373461c373460,373461
< 005b2d30: 3030 676e 2f54 2f67 6f2d 6c69 6e6b 2d32  00gn/T/go-link-2
< 005b2d40: 3437 3532 3038 3139 2f30 3030 3030 302e  47520819/000000.
---
> 005b2d30: 3030 676e 2f54 2f67 6f2d 6c69 6e6b 2d31  00gn/T/go-link-1
> 005b2d40: 3436 3636 3739 3636 2f30 3030 3030 302e  46667966/000000.
373480,373481c373480,373481
< 005b2e70: 3067 6e2f 542f 676f 2d6c 696e 6b2d 3234  0gn/T/go-link-24
< 005b2e80: 3735 3230 3831 392f 3030 3030 3031 2e6f  7520819/000001.o
---
> 005b2e70: 3067 6e2f 542f 676f 2d6c 696e 6b2d 3134  0gn/T/go-link-14
> 005b2e80: 3636 3637 3936 362f 3030 3030 3031 2e6f  6667966/000001.o
374078,374079c374078,374079
< 005b53d0: 542f 676f 2d6c 696e 6b2d 3234 3735 3230  T/go-link-247520
< 005b53e0: 3831 392f 3030 3030 3033 2e6f 005f 5f63  819/000003.o.__c
---
> 005b53d0: 542f 676f 2d6c 696e 6b2d 3134 3636 3637  T/go-link-146667
> 005b53e0: 3936 362f 3030 3030 3033 2e6f 005f 5f63  966/000003.o.__c
374098,374099c374098,374099
< 005b5510: 2f67 6f2d 6c69 6e6b 2d32 3437 3532 3038  /go-link-2475208
< 005b5520: 3139 2f30 3030 3030 342e 6f00 5f5f 6367  19/000004.o.__cg
---
> 005b5510: 2f67 6f2d 6c69 6e6b 2d31 3436 3636 3739  /go-link-1466679
> 005b5520: 3636 2f30 3030 3030 342e 6f00 5f5f 6367  66/000004.o.__cg
374124c374124
< 005b56b0: 2d6c 696e 6b2d 3234 3735 3230 3831 392f  -link-247520819/
---
> 005b56b0: 2d6c 696e 6b2d 3134 3636 3637 3936 362f  -link-146667966/
374138c374138
< 005b5790: 2d6c 696e 6b2d 3234 3735 3230 3831 392f  -link-247520819/
---
> 005b5790: 2d6c 696e 6b2d 3134 3636 3637 3936 362f  -link-146667966/
374155c374155
< 005b58a0: 6b2d 3234 3735 3230 3831 392f 3030 3030  k-247520819/0000
---
> 005b58a0: 6b2d 3134 3636 3637 3936 362f 3030 3030  k-146667966/0000
374173,374174c374173,374174
< 005b59c0: 542f 676f 2d6c 696e 6b2d 3234 3735 3230  T/go-link-247520
< 005b59d0: 3831 392f 3030 3030 3038 2e6f 005f 6475  819/000008.o._du
---
> 005b59c0: 542f 676f 2d6c 696e 6b2d 3134 3636 3637  T/go-link-146667
> 005b59d0: 3936 362f 3030 3030 3038 2e6f 005f 6475  966/000008.o._du
374186c374186
< 005b5a90: 6c69 6e6b 2d32 3437 3532 3038 3139 2f30  link-247520819/0
---
> 005b5a90: 6c69 6e6b 2d31 3436 3636 3739 3636 2f30  link-146667966/0
374194,374195c374194,374195
< 005b5b10: 542f 676f 2d6c 696e 6b2d 3234 3735 3230  T/go-link-247520
< 005b5b20: 3831 392f 3030 3030 3130 2e6f 005f 6475  819/000010.o._du
---
> 005b5b10: 542f 676f 2d6c 696e 6b2d 3134 3636 3637  T/go-link-146667
> 005b5b20: 3936 362f 3030 3030 3130 2e6f 005f 6475  966/000010.o._du
374211c374211
< 005b5c20: 6c69 6e6b 2d32 3437 3532 3038 3139 2f30  link-247520819/0
---
> 005b5c20: 6c69 6e6b 2d31 3436 3636 3739 3636 2f30  link-146667966/0
374221,374222c374221,374222
< 005b5cc0: 676f 2d6c 696e 6b2d 3234 3735 3230 3831  go-link-24752081
< 005b5cd0: 392f 3030 3030 3132 2e6f 005f 6475 6b5f  9/000012.o._duk_
---
> 005b5cc0: 676f 2d6c 696e 6b2d 3134 3636 3637 3936  go-link-14666796
> 005b5cd0: 362f 3030 3030 3132 2e6f 005f 6475 6b5f  6/000012.o._duk_
374240c374240
< 005b5df0: 696e 6b2d 3234 3735 3230 3831 392f 3030  ink-247520819/00
---
> 005b5df0: 696e 6b2d 3134 3636 3637 3936 362f 3030  ink-146667966/00
375409c375409
< 005ba700: 2d6c 696e 6b2d 3234 3735 3230 3831 392f  -link-247520819/
---
> 005ba700: 2d6c 696e 6b2d 3134 3636 3637 3936 362f  -link-146667966/
375419,375420c375419,375420
< 005ba7a0: 676e 2f54 2f67 6f2d 6c69 6e6b 2d32 3437  gn/T/go-link-247
< 005ba7b0: 3532 3038 3139 2f30 3030 3031 382e 6f00  520819/000018.o.
---
> 005ba7a0: 676e 2f54 2f67 6f2d 6c69 6e6b 2d31 3436  gn/T/go-link-146
> 005ba7b0: 3636 3739 3636 2f30 3030 3031 382e 6f00  667966/000018.o.
375438,375439c375438,375439
< 005ba8d0: 676f 2d6c 696e 6b2d 3234 3735 3230 3831  go-link-24752081
< 005ba8e0: 392f 3030 3030 3231 2e6f 005f 5f63 676f  9/000021.o.__cgo
---
> 005ba8d0: 676f 2d6c 696e 6b2d 3134 3636 3637 3936  go-link-14666796
> 005ba8e0: 362f 3030 3030 3231 2e6f 005f 5f63 676f  6/000021.o.__cgo
375445,375446c375445,375446
< 005ba940: 676e 2f54 2f67 6f2d 6c69 6e6b 2d32 3437  gn/T/go-link-247
< 005ba950: 3532 3038 3139 2f30 3030 3032 322e 6f00  520819/000022.o.
---
> 005ba940: 676e 2f54 2f67 6f2d 6c69 6e6b 2d31 3436  gn/T/go-link-146
> 005ba950: 3636 3739 3636 2f30 3030 3032 322e 6f00  667966/000022.o.
375456c375456
< 005ba9f0: 6c69 6e6b 2d32 3437 3532 3038 3139 2f30  link-247520819/0
---
> 005ba9f0: 6c69 6e6b 2d31 3436 3636 3739 3636 2f30  link-146667966/0
375479c375479
< 005bab60: 2d32 3437 3532 3038 3139 2f30 3030 3032  -247520819/00002
---
> 005bab60: 2d31 3436 3636 3739 3636 2f30 3030 3032  -146667966/00002
375486,375487c375486,375487
< 005babd0: 2f54 2f67 6f2d 6c69 6e6b 2d32 3437 3532  /T/go-link-24752
< 005babe0: 3038 3139 2f30 3030 3032 352e 6f00 5f78  0819/000025.o._x
---
> 005babd0: 2f54 2f67 6f2d 6c69 6e6b 2d31 3436 3636  /T/go-link-14666
> 005babe0: 3739 3636 2f30 3030 3032 352e 6f00 5f78  7966/000025.o._x
375493c375493
< 005bac40: 2d32 3437 3532 3038 3139 2f30 3030 3032  -247520819/00002
---
> 005bac40: 2d31 3436 3636 3739 3636 2f30 3030 3032  -146667966/00002
375502c375502
< 005bacd0: 696e 6b2d 3234 3735 3230 3831 392f 3030  ink-247520819/00
---
> 005bacd0: 696e 6b2d 3134 3636 3637 3936 362f 3030  ink-146667966/00
DIFF_END
```
